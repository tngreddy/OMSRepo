
<div class="panel panel-default mainWrapper custompanel hidden-print">
	<!-- Default panel contents -->
	<div class="panel-heading">
		<span class="lead">Goods Returnable Challan </span>
	</div>

<div class="filtercontainer">

	<div class="searchPanel" >

		<form novalidate angular-validator name="grcDataForm"
			class="form-horizontal">
			<div class="">
				<label class="col-sm-3 control-label">GRC No</label>
				<div class="col-sm-5">
					<input type="text" class="form-control" validate-on="dirty"
						name="grcNo" placeholder="GRC No" ng-model="grcNo"
						required-message="'GRC No is required'" required />
				</div>
			</div>
			<button type="submit" class="btn btn-flat btn-primary" name="search"
				ng-click="fetchGRCData(grcNo,false)">
				<span data-ng-hide="loading"> Search </span> <span
					data-ng-show="loading"> Searching <i
					class="fa fa-spinner fa-spin"></i></span>
			</button>
			<button type="submit" class="btn btn-flat btn-primary"
				ng-click="fetchGRCData(grcNo,true)">Get Print Format</button>
		</form>
		
	</div>
	<!-- <div style="width:20%;float:left;"><button type="button" class="btn btn-flat btn-primary pull-right"
			uib-tooltip="Click to see all the pending GRCs" ng-click="fetchPendingGRCs()">
			Partial Pending GRCs </button>
	</div> -->
	<div class="createBtnPanel">
	<button type="button" class="btn btn-flat bg-olive pull-right" uib-tooltip="Create a new GRC"
			ng-click="createGRCModal()">
			<i class="fa fa-plus"></i> Create GRC </button>
	</div>
	
	</div>

</div>
<div ng-show="showGRCData"
	class="panel panel-default mainWrapper dataPanel">
	<div class="panel-heading">
		<span class="lead">{{grcData.grc.grcNo}} </span>
	</div>
	<div ng-show=user.isAdmin class="modal-footer">
		<button class="btn btn-flat btn-warning"
			ng-click="editGRCModal(grcData)">
			<i class="fa fa-edit "></i> Edit
		</button>
		<button class="btn btn-flat btn-danger"
			ng-click="deleteGRCModal(grcData)">
			<i class="fa fa-trash "></i> Delete
		</button>
	</div>

	<div class="tablecontainer">

		<h4>
			<span class="label label-default">Data</span>
		</h4>

		<table id="grcTable" class="table table-bordered table-striped">
			<thead>
				<tr>
					<th>GRC No</th>
					<th>From</th>
					<th>From Name</th>
					<th>Doc Ref No</th>
					<th>Doc Date</th>
					<th>Status</th>
					<th>GRC Date</th>

				</tr>
			</thead>
			<tbody>
				<tr>
					<td><span ng-bind="grcData.grc.grcNo"></span></td>
					<td><span ng-bind="grcData.grc.to"></span></td>
					<td><span ng-bind="grcData.grc.toName"></span></td>
					<td><span ng-bind="grcData.grc.docRefNo"></span></td>
					<td><span ng-bind="grcData.grc.docDate"></span></td>
					<td><span ng-bind="grcData.grc.status"></span></td>
					<td><span ng-bind="grcData.grc.grcDate"></span></td>

				</tr>
			</tbody>
		</table>
	</div>
	<div class="tablecontainer">

		<h4>
			<span class="label label-default">Products Info</span>
		</h4>

		<table id="grcTable" class="table table-bordered table-striped">
			<thead>
				<tr>
					<th>Product Id</th>
					<th>Product Name</th>
					<th>Good Out</th>
					<th>Def Out</th>
					<th>Total Qty</th>
					<th>unit Basic Rate</th>
					<th>Total Amount</th>
					<th>Status</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="prodInfo in grcData.grc.prodInfoList">
					<td><span ng-bind="prodInfo.product.productId"></span></td>
					<td><span ng-bind="prodInfo.product.productName"></span></td>
					<td><span ng-bind="prodInfo.goodOut"></span></td>
					<td><span ng-bind="prodInfo.defOut"></span></td>
					<td><span ng-bind="prodInfo.totalQty"></span></td>
					<td><span ng-bind="prodInfo.unitBasicRate"></span></td>
					<td><span ng-bind="prodInfo.totalAmount"></span></td>
					<td><span ng-bind="prodInfo.status"></span></td>
				</tr>
			</tbody>
		</table>
	</div>
	
	<div class="tablecontainer" ng-show="grcData.grc.partPndgProdInfoList.length>0">

		<h4>
			<span class="label label-default">Partial Pending Products Info</span>
		</h4>

		<table id="grcTable" class="table table-bordered table-striped">
			<thead>
				<tr>
					<th>Product Id</th>
					<th>Product Name</th>
					<th>Rem Good Out</th>
					<th>Rem Def Out</th>
					<th>Rem Total Qty</th>
					<th>unit Basic Rate</th>
					<th>Rem Total Amount</th>
					<th>Status</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="parProdInfo in grcData.grc.partPndgProdInfoList">
					<td><span ng-bind="parProdInfo.product.productId"></span></td>
					<td><span ng-bind="parProdInfo.product.productName"></span></td>
					<td><span ng-bind="parProdInfo.goodOut"></span></td>
					<td><span ng-bind="parProdInfo.defOut"></span></td>
					<td><span ng-bind="parProdInfo.totalQty"></span></td>
					<td><span ng-bind="parProdInfo.unitBasicRate"></span></td>
					<td><span ng-bind="parProdInfo.totalAmount"></span></td>
					<td><span ng-bind="parProdInfo.status"></span></td>
				</tr>
			</tbody>
		</table>
	</div>
</div>


<div ng-show="showGRCDetails" class="printFormatPanel" ng-init="showCust={{grcData.hasCustomer}}">
	<table class="table table-bordered" style="margin-bottom:2px;">
			 <tr class="header" ng-include="'resources/templates/common/header.html'" >
		     </tr>
			<tr>
				<td colspan="2">
					<h3 class="text-center">
						<u>GOODS RETURNABLE CHALLAN</u>
					</h3></td>
			</tr>
			<tr ng-include="'resources/templates/common/registrationDetails.html'">
				
			</tr>
			<tr>
				<td style="padding:0px;"><span><strong>To</strong><span>
				  <div class="fromAddress">
					<address>
						<strong>{{grcData.toDetails.name}}</strong><br>
						{{grcData.toDetails.contact.address.addressLine1}}
						{{grcData.toDetails.contact.address.addressLine2}}<br>
						{{grcData.toDetails.contact.address.city}}<br>
						{{grcData.toDetails.contact.address.state}}-
						{{grcData.toDetails.contact.address.pinCode}}
					</address>
					</div>
					</td>
				<td style="padding:0px;">
				<table class="table table-bordered" style="margin-bottom: 0px;border: 0px;">
						<tr>
							<td width="35%"><span>GRC NO</span></td>
							<td width="65%"><span>{{grcData.grc.grcNo}}</span></td>
						</tr>
						<tr>
							<td><span>GRC DATE</span></td>
							<td><span>{{grcData.grc.grcDate}}</span></td>
						</tr>
						<tr>
							<td><span>GRC DOC REF</span></td>
							<td><span>{{grcData.grc.docRefNo}}</span></td>
						</tr>
					</table></td>
			</tr>
			<tr>
				<td><span>{{grcData.grc.to}}</span></td>
				<td><span>Name : {{grcData.grc.toName}}</span></td>
			</tr>
			<tr>
				<td><span>Contact No : </span><span>{{grcData.toDetails.contact.phoneNo}}</span></td>
				<td><span>TIN : </span><span>{{grcData.toDetails.tinNo}}</span> </td>
			</tr>
			<tr>
				<td><span>Mobile No : </span><span>{{grcData.toDetails.contact.mobileNo}}</span></td>
				<td><span>CST No : </span><span>{{grcData.toDetails.cstNo}}</span> </td>
			</tr>
			<tr>
				<td><span>Fax No : </span><span></span></td>
				<td><span>Despatch Details :</span><span></span></td>
			</tr>
			<tr>
				<td><span>Email : </span></td>
				<td><span>DC No & Date : </span><span></span></td>
			</tr>
			<tr>
				<td colspan="2" style="padding:0px;">
				<table class="table table-bordered" style="margin:0px;border:0px;">
						<tr class="text-center">
							<td width="3%"><span>SNo</span></td>
							<td width="42%"><span>Description</span></td>
							<td width="7%"><span>Good Out</span></td>
							<td width="7%"><span>Def Out</span></td>
							<td width="7%"><span>Total Qty</span></td>
							<td width="7%"><span>Unit Of Measure</span></td>
							<td width="7%"><span>Unit Basic Rate</span></td>
							<td width="10%"><span>Total Amount</span></td>
						</tr>
						<tr ng-repeat="prodInfo in grcData.grc.prodInfoList">
							<td><span style="float:right;" ng-bind="$index+1"></span></td>
							<td><span ng-bind="prodInfo.product.productName"></span></td>
							<td><span style="float:right;" ng-bind="prodInfo.goodOut"></span></td>
							<td><span style="float:right;" ng-bind="prodInfo.defOut"></span></td>
							<td><span style="float:right;" ng-bind="prodInfo.totalQty"></span></td>
							<td><span ng-bind="prodInfo.product.unitOfMeasure"></span></td>
							<td><span style="float:right;" ng-bind="prodInfo.unitBasicRate"></span></td>
							<td><span style="float:right;" ng-bind="prodInfo.totalAmount"></span></td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td colspan="2"><span>VALUE : (FOR OCTROI PURPOSES)</span></td>
			</tr>
			<tr>
				<td colspan="2"><span>REMARKS : </span><span>&nbsp;{{grcData.grc.remarks}}</span><br><br></td>
			</tr>
			<tr>
				<td><span>Received the above material in Good Condition</span><br> <br>
				<br> <span>Receiver's Signature with Stamp</span></td>
				<td>
					<div class="text-right">
						<span style="font-size:12px;"><Strong>For VIJAYA ENTERPRISES</Strong></span><br> <br>
						<br><span>Authorised Signatory</span>
					</div>
				</td>
			</tr>
	</table>
	<span> NOTE: The above Transaction is not sale</span>

</div>
<!-- <div class="panel panel-default mainWrapper custompanel">
		Default panel contents
		<div class="panel-heading">
			<span class="lead">Goods Returnable Challan </span>
		</div>

<div class="addbuttoncontainer"><button type="button" class="btn btn-flat bg-olive " ng-click="createGRCModal()">
  <i class="fa fa-plus"></i> Create GRC</button>
 </div>
        
		<div class="tablecontainer">
		<table id="grcTable"
			class="table table-bordered table-striped">
			<thead>
                      <tr>
                        <th>GRC No</th>
                        <th>To</th>
                        <th>To Name</th>
                        <th>Doc Ref No</th>
                        <th>Doc Date</th>
                        <th>Product Name</th>
                        <th>Good Out</th>
                        <th>Def Out</th>
                        <th>Status</th>
                        <th>GRC Date</th>
					<th width="5%">Edit</th>
					<th width="5%">Delete</th>
                        </tr>
                    </thead>
				<tbody>
					<tr ng-repeat="grc in grcs">
						<td><span ng-bind="grc.grcNo"></span></td>
						<td><span ng-bind="grc.to"></span></td>
						<td><span ng-bind="grc.toName"></span></td>
						<td><span ng-bind="grc.docRefNo"></span></td>
						<td><span ng-bind="grc.docDate"></span></td>
						<td><span ng-bind="grc.product.productName"></span></td>
						<td><span ng-bind="grc.goodOut"></span></td>
						<td><span ng-bind="grc.defOut"></span></td>
						<td><span ng-bind="grc.status"></span></td>
						<td><span ng-bind="grc.grcDate"></span></td>
						<td><button class="btn btn-flat btn-sm btn-warning" ng-click="editGRCModal(grc)"><i class="fa fa-edit "></i></button></td>
						<td><button class="btn btn-flat btn-sm btn-danger" ng-click="deleteGRCModal(grc)"><i class="fa fa-trash "></i></button></td>
					</tr>
				</tbody>
			</table>
		</div>
</div> -->
<div ng-show="showPendingGRCs"
	class="panel panel-default mainWrapper dataPanel">
	<div class="panel-heading">
		<span class="lead">Partial Pending GRCs</span>
	</div>
	
	<div class="tablecontainer">
	<br>
		<table id="grcTable" class="table table-bordered table-striped">
			<thead>
				<tr>
					<th>GRC No</th>
					<th>Product Id</th>
					<th>Product Name</th>
					<th>Rmng Good Out</th>
					<th>Rmng Def Out</th>
					<th>Rmng Total Qty</th>
					<th>unit Basic Rate</th>
					<th>Rmng Total Amount</th>
					<th>Status</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="pendingGRC in pendingGRCs">
					<td><span ng-bind="pendingGRC.grcNo"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.product.productId"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.product.productName"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.goodOut"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.defOut"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.totalQty"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.unitBasicRate"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.totalAmount"></span></td>
					<td><span ng-bind="pendingGRC.prodInfo.status"></span></td>
				</tr>
			</tbody>
		</table>
	</div>
</div>


<!-- Create GRC overlay -->
<modal size="modal-lg" visible="showAddModal">
<form novalidate angular-validator
	angular-validator-submit="createGRC()" name="createGRCForm"
	class="form-horizontal">
	<div class="modal-header with-border">
		<button type="button" class="close" data-dismiss="modal"
			aria-label="Close">
			<span aria-hidden="true">&times;</span>
		</button>
		<h4 class="modal-title" id="myModalLabel">Create GRC</h4>
	</div>
	<div class="modal-body">
		<div class="box-body">
		<div class="filtercontainer">
			<div class="form-left">
				<label class="col-sm-3 control-label">To</label>
				<div class="col-sm-8 selectContainer">
					<select class="form-control" " name="to"
							ng-model="grc.to" 
							ng-change="populateFromData(grc.to)"
							validate-on="dirty"
							required-message="'To is required'" required>
							<option	value="SUPPLIER">SUPPLIER</option>
							<option	value="CUSTOMER">CUSTOMER</option>
							<option	value="OTHERS">OTHERS</option>
						</select>
				</div>
			</div>
			
			<div class="form-left">
				<label class="col-sm-3 control-label">To Name</label>
				<div class="col-sm-8 selectContainer">
						<select class="form-control" name="toName"
							ng-model="grc.toName" validate-on="dirty"
							required-message="'To Name is required'" required>
							<option	ng-selected="{{data.name == grc.ToName}}"
								    ng-repeat="data in dataList" value="{{data.name}}">{{data.name}}</option>
						</select>
				</div>
			</div>
			</div>
			<div class="filtercontainer">
			<div class="form-left">
				<label class="col-sm-3 control-label">Doc Ref No</label>
				<div class="col-sm-8">
					<input type="text" 
					    class="form-control" 
					    validate-on="dirty"
						name="docRefNo" 
						placeholder="Doc Ref No"
						ng-model="grc.docRefNo"
						required-message="'Doc Ref No is required'" required />
				</div>
			</div>
			
			<div class="form-left">
				<label class="col-sm-3 control-label">Doc Date</label>
				<div class="col-sm-8">
				<input type="text" class="form-control"  ng-click="open($event)"
						validate-on="dirty"
						name="docDate" 
						placeholder="Doc Date"
						ng-model="grc.docDateValue"
						uib-datepicker-popup="dd/MM/yyyy" is-open="status.opened" max-date="maxDate" close-text="Close"
						required-message="'Doc Date is required'" required readonly />
			   
			</div>
			</div>
			
		</div>	
	<div class="prodContainer">
	<span class="btn btn-danger  btn-flat btn-xs">Product Info</span>
		<fieldset  data-ng-repeat="prodInfo in grc.prodInfoList">
	<div>	
	<div class="filtercontainer">		

			<div class="form-left width33">
				<label class="col-sm-3 control-label">Product Name</label>
				<div class="col-sm-8">
					<select class="form-control" name="productName{{$index}}"
							ng-model="prodInfo.product.productId" validate-on="dirty"
							required-message="'Product Name is required'" required>
							<option	ng-repeat="product in productsInfo" value="{{product.id}}">{{product.name}}</option>
						</select>
						</div>
			</div>

	<div class="form-left width33">
				<label class="col-sm-4 control-label">Good Out</label>
				<div class="col-sm-8">
					<input type="number" min="0" 
					    class="form-control" 
					    validate-on="dirty"
						name="goodOut{{$index}}" 
						placeholder="Good Out"
						ng-model="prodInfo.goodOut"
						invalid-message="'Good Out should be a postive number'"
						/>
				</div>
			</div>
			
	<div class="form-left width33">

				<label class="col-sm-3 control-label">Defective Out</label>
				<div class="col-sm-8">
					<input type="number" min="0" 
					    class="form-control" 
					    validate-on="dirty"
						name="defectiveOut{{$index}}" 
						placeholder="Defective Out"
						ng-model="prodInfo.defOut"
						invalid-message="'Defective Out should be a postive number'"
						 />
				</div>
			</div>
	</div>
	</div>
      
   </fieldset>
   <div style="height: 34px;">
   		<a class="btn btn-flat btn-danger pull-right"  ng-click="removeChoice()">-</a>
  		<a class="btn btn-flat bg-olive pull-right"  ng-click="addNewChoice()">+</a>
   </div>
   </div>
		<div class="filtercontainer">
			
		     <div class="form-group">
				<label class="col-sm-2 control-label">Remarks</label>
				<div class="col-sm-9">
					<textarea rows="3"
					    class="form-control" 
					    validate-on="dirty"
						name="remarks" 
						placeholder="Remarks"
						ng-model="grc.remarks"
						></textarea>
				</div>
			</div>
			
		</div>
		
	</div>	
	<div class="modal-footer">
		<button type="button" class="btn btn-flat btn-default" data-dismiss="modal">Close</button>
		<button type="submit" class="btn btn-flat btn-primary">Create</button>
	</div>
</form>
</modal>


